/*
Author Info
Student ID: 9080545462
NetID:      rshen27
*/
SELECT n.N_NAME AS [CountryName], SUM(l.L_QUANTITY*(l.L_EXTENDEDPRICE -l.L_DISCOUNT)) AS [OrderVolume]
FROM NATION AS n 
JOIN SUPPLIER AS s ON n.N_NATIONKEY = s.S_NATIONKEY
JOIN LINEITEM AS l ON s.S_SUPPKEY = l.L_SUPPKEY
JOIN CUSTOMER AS c ON n.N_NATIONKEY = s.S_NATIONKEY
JOIN ORDERS AS o ON c.C_CUSTKEY = o.O_CUSTKEY
WHERE o.O_ORDERKEY = l.L_ORDERKEY AND  c.C_NATIONKEY = s.S_NATIONKEY 
GROUP BY n.N_NAME
ORDER BY n.N_NAME;