/*
Author Info
NetID:      rshen27
*/
SELECT n.N_NAME AS [CountryName], SUM(Uni.OrderSize) AS [OrderVolume]
FROM NATION AS n 
LEFT OUTER JOIN 
(	
	SELECT *, SUM(l.L_QUANTITY*(l.L_EXTENDEDPRICE - l.L_DISCOUNT)) AS [OrderSize]
	FROM ORDERS AS o 
	JOIN LINEITEM AS l ON o.O_ORDERKEY = l.L_ORDERKEY	JOIN SUPPLIER AS s ON l.L_SUPPKEY = s.S_SUPPKEY
	JOIN CUSTOMER AS c ON o.O_CUSTKEY = c.C_CUSTKEY
	WHERE c.C_NATIONKEY = s.S_NATIONKEY
	GROUP BY o.O_ORDERKEY
) AS Uni 
ON n.N_NATIONKEY = Uni.S_NATIONKEY 
GROUP BY n.N_NAME
ORDER BY n.N_NAME;
