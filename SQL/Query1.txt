/*
Author Info
NetID:      rshen27
*/

SELECT c.C_NAME AS [CustomerName], o.O_ORDERKEY AS [OrderNumber], SUM(l.L_QUANTITY*(l.L_EXTENDEDPRICE - l.L_DISCOUNT)) AS [OrderSize]
FROM ORDERS AS o 
LEFT OUTER JOIN LINEITEM AS l ON o.O_ORDERKEY = l.L_ORDERKEY
LEFT OUTER JOIN CUSTOMER AS c ON o.O_CUSTKEY = c.C_CUSTKEY
GROUP BY o.O_ORDERKEY
ORDER BY OrderSize DESC
LIMIT 20;
